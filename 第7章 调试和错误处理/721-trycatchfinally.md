##try...catch...finally

&emsp;&emsp;C#è¯­è¨€åŒ…å«**ç»“æ„åŒ–å¼‚å¸¸å¤„ç†**ï¼ˆStructured Exception Handling, **SEH**ï¼‰çš„è¯­æ³•ã€‚ç”¨ 3 ä¸ªå…³é”®å­—å¯ä»¥æ ‡è®°å‡ºèƒ½å¤„ç†å¼‚å¸¸çš„ä»£ç å’ŒæŒ‡ä»¤ï¼Œå¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œå°±ä½¿ç”¨è¿™äº›æŒ‡ä»¤å¤„ç†å¼‚å¸¸ã€‚ç”¨äºè¿™ä¸ªç›®çš„çš„ 3 ä¸ªå…³é”®å­—æ˜¯ `try`ã€`catch`å’Œ `finally`ã€‚å®ƒä»¬éƒ½æœ‰ä¸€ä¸ªå…³è”çš„ä»£ç å—ï¼Œå¿…é¡»åœ¨è¿ç»­çš„ä»£ç è¡Œä¸­ä½¿ç”¨ã€‚å…¶åŸºæœ¬ç»“æ„å¦‚ä¸‹ï¼š

```javascript
        try
        {
            ...
        }
        catch(<exceptionType> e)
        {
            ...
        }
        finally
        {
            ...
        }
```

&emsp;&emsp;ä¹Ÿå¯ä»¥åªæœ‰ `try` å—å’Œ `finally` å—ï¼Œè€Œæ²¡æœ‰ `catch` å—ï¼Œæˆ–è€…æœ‰ä¸€ä¸ª `try` å—å’Œå¥½å‡ ä¸ª `catch` å—ã€‚å¦‚æœæœ‰ä¸€ä¸ªæˆ–å¤šä¸ª `catch` å—ï¼Œ`finally` å—å°±æ˜¯å¯é€‰çš„ï¼Œå¦åˆ™å°±æ˜¯å¿…éœ€çš„ã€‚è¿™äº›ä»£ç å—çš„ç”¨æ³•å¦‚ä¸‹ï¼š

&emsp;&emsp;â— **try** -- åŒ…å«æŠ›å‡ºå¼‚å¸¸çš„ä»£ç ï¼ˆåœ¨è°ˆåˆ°å¼‚å¸¸æ—¶ï¼ŒC#è¯­è¨€ç”¨ â€œæŠ›å‡ºâ€è¿™ä¸ªæœ¯è¯­è¡¨ç¤º â€œç”Ÿæˆâ€ æˆ– â€œå¯¼è‡´â€ï¼‰ã€‚

&emsp;&emsp;â— **catch** -- åŒ…å«æŠ›å‡ºå¼‚å¸¸æ—¶è¦æ‰§è¡Œçš„ä»£ç ã€‚`catch` å—å¯ä»¥ä½¿ç”¨ `<exceptionType>`ï¼Œè®¾ç½®ä¸ºåªå“åº”ç‰¹å®šçš„å¼‚å¸¸ç±»å‹ï¼ˆå¦‚System.IndexOutOfRangeExceptionï¼‰ï¼Œä»¥ä¾¿æä¾›å¤šä¸ª `catch` å—ã€‚è¿˜å¯ä»¥å®Œå…¨çœç•¥è¿™ä¸ªå‚æ•°ï¼Œè®©ä¸€èˆ¬çš„ `catch` å—å“åº”æ‰€æœ‰å¼‚å¸¸ã€‚

&emsp;&emsp;â— **finally** -- åŒ…å«å§‹ç»ˆä¼šæ‰§è¡Œçš„ä»£ç ï¼Œå¦‚æœæ²¡æœ‰äº§ç”Ÿå¼‚å¸¸ï¼Œåˆ™åœ¨ `try` å—ä¹‹åæ‰§è¡Œï¼Œå¦‚æœå¤„ç†äº†å¼‚å¸¸ï¼Œå°±åœ¨ `catch` å—åæ‰§è¡Œï¼Œæˆ–è€…åœ¨æœªå¤„ç†çš„å¼‚å¸¸ä¸Šç§»åˆ°è°ƒç”¨å †æ ˆä¹‹å‰æ‰§è¡Œã€‚â€œä¸Šç§»åˆ°è°ƒç”¨å †æ ˆâ€è¡¨ç¤ºï¼ŒSEHå…è®¸åµŒå¥— `try...catch...finally` å—ï¼Œå¯ä»¥ç›´æ¥åµŒå¥—ï¼Œä¹Ÿå¯ä»¥åœ¨ `try` å—åŒ…å«çš„å‡½æ•°è°ƒç”¨ä¸­åµŒå¥—ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåœ¨è¢«è°ƒç”¨çš„å‡½æ•°ä¸­æ²¡æœ‰ `catch` å—èƒ½å¤„ç†æŸä¸ªå¼‚å¸¸ï¼Œå°±ç”±è°ƒç”¨ä»£ç ä¸­çš„ `catch` å—å¤„ç†ã€‚å¦‚æœå§‹ç»ˆæ²¡æœ‰åŒ¹é…çš„ `catch` å—ï¼Œå°±ç»ˆæ­¢åº”ç”¨ç¨‹åºã€‚`finally` å—åœ¨æ­¤ä¹‹å‰å¤„ç†æ­£æ˜¯å…¶å­˜åœ¨çš„æ„ä¹‰ï¼Œå¦åˆ™ä¹Ÿå¯ä»¥åœ¨ `try...catch...finally` ç»“æ„çš„å¤–éƒ¨æ”¾ç½®ä»£ç ã€‚è¿™ä¸ªåµŒå¥—åŠŸèƒ½å°†åœ¨åé¢çš„ â€œå¼‚å¸¸å¤„ç†çš„æ³¨æ„äº‹é¡¹â€ ä¸€èŠ‚ä¸­è¿›ä¸€æ­¥è®¨è®ºï¼Œæ‰€ä»¥å¦‚æœå¯¹è¿™ä¸ªåŠŸèƒ½æ„Ÿåˆ°å›°æƒ‘ä¸è§£ï¼Œè¯·ä¸å¿…æ‹…å¿ƒã€‚

&emsp;&emsp;åœ¨ `try` å—çš„ä»£ç ä¸­å‡ºç°å¼‚å¸¸åï¼Œå‘ç”Ÿçš„äº‹ä»¶ä¾æ¬¡æ˜¯ï¼š

&emsp;&emsp;â— try å—åœ¨å‘ç”Ÿå¼‚å¸¸çš„åœ°æ–¹ä¸­æ–­ç¨‹åºçš„æ‰§è¡Œã€‚

&emsp;&emsp;â— å¦‚æœæœ‰ `catch` å—ï¼Œå°±æ£€æŸ¥è¯¥å—æ˜¯å¦åŒ¹é…å·²æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ã€‚å¦‚æœæ²¡æœ‰ `catch` å—ï¼Œå°±æ‰§è¡Œ `finally` å—ï¼ˆå¦‚æœæ²¡æœ‰ `catch` å—ï¼Œå°±ä¸€å®šè¦æœ‰ `finally` å—ï¼‰ã€‚

&emsp;&emsp;â— å¦‚æœæœ‰ `catch` å—ï¼Œä½†å®ƒä¸å·²å‘ç”Ÿçš„å¼‚å¸¸ç±»å‹ä¸åŒ¹é…ï¼Œå°±æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»– `catch` å—ã€‚

&emsp;&emsp;â— å¦‚æœæœ‰ `catch` å—åŒ¹é…å·²å‘ç”Ÿçš„å¼‚å¸¸ç±»å‹ï¼Œå°±æ‰§è¡Œå®ƒåŒ…å«çš„ä»£ç ï¼Œå†æ‰§è¡Œ `finally` å—ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚

&emsp;&emsp;â— å¦‚æœ `catch` å—éƒ½ä¸åŒ¹é…å·²å‘ç”Ÿçš„å¼‚å¸¸ç±»å‹ï¼Œå°±æ‰§è¡Œ `finally` å—ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚

>&emsp;&emsp;ä¸‹é¢ç”¨ä¸€ä¸ªç¤ºä¾‹æ¥è¯´æ˜å¼‚å¸¸çš„å¤„ç†ã€‚è¿™ä¸ªç¤ºä¾‹ä»¥å‡ ç§æ–¹å¼æŠ›å‡ºå’Œå¤„ç†å¼‚å¸¸ï¼Œä»¥ä¾¿è¯»è€…äº†è§£å…¶æœºåˆ¶ã€‚

>&emsp;&emsp;ä¿®æ”¹ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ˆè¿™é‡Œæ˜¾ç¤ºçš„è¡Œå·æ³¨é‡Šæœ‰åŠ©äºå°†ä»£ç ä¸åé¢è®¨è®ºçš„å†…å®¹è”ç³»èµ·æ¥ï¼Œåœ¨æœ¬ç« çš„å¯ä¸‹è½½ä»£ç ä¸­ä¹ŸåŒ…å«è¿™äº›è¡Œå·ï¼Œä»¥æ–¹ä¾¿å‚è€ƒï¼‰ï¼š

```javascript
        class Program
        {
            static string[] eTypes = { "none", "simple", "index", "nested index" };

            static void Main(string[] args)
            {
                foreach (string eType in eTypes)
                {
                    try
                    {
                        Console.WriteLine("Main() try block reached.");        // Line 19
                        Console.WriteLine("ThrowException(\"{0}\") called.", eType);
                        ThrowException(eType);
                        Console.WriteLine("Main() try block continues.");      // Line 22
                    }
                    catch (System.IndexOutOfRangeException e)                  // Line 24
                    {
                        Console.WriteLine("Main() System.IndexOutOfRangeException catch"
                                           + "block reached. Message:\n\"{0}\"", 
                                           e.Message);
                    }
                    catch                                                      // Line 30
                    {
                        Console.WriteLine("Main() general catch block reached.");
                    }
                    finally
                    {
                        Console.WriteLine("Main() finally block reached.");
                    }
                    Console.WriteLine();
                }
                Console.ReadKey();
            }
        }
```












ğŸ”š